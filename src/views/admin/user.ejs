<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/icon.css" />
    <link rel="stylesheet" href="/css/styles.css" />
    <script src="/js/jquery.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
  </head>
  <body>
    <%- include('../partials/nav_admin.ejs') %>
    <div class="container">
      <!-- Title -->
      <div class="row container">
        <!-- Title page -->
        <h2 class="text-primary">User List</h2>
          <a href="/admin/user/add">
            <span
              class="badge badge-pill badge-primary"
              style="background-color: white;"
              ><i style="color: blue;" class="fas fa-plus"></i></span
          ></a>
      </div>
      <!-- Nav tab -->
      <ul class="nav nav-tabs mb-2">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#Student"
            >Student</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#Lecturer">Lecturer</a>
        </li>
      </ul>
      <div class="tab-content">
        <!-- Tab Student -->
        <div id="Student" class="container tab-pane active">
          <!-- Title Tab Student -->
          <h2 class="text-primary">Student List</h2>
          <!-- Search -->
          <input
            class="form-control"
            id="searchStudent"
            type="text"
            placeholder="Search..."
          />
          <!-- Table list Students -->
          <table
            style="margin-top: 10px;"
            class="table table-bordered table-hover"
          >
            <!-- Header table -->
            <thead class="thead-dark">
              <tr>
                <th>STT</th>
                <th>ID</th>
                <th>Full Name</th>
                <th>Email</th>
                <th>Edit</th>
                <th>Delete</th>
              </tr>
            </thead>
            <!-- Body table -->
            <tbody id="tableStudent">
              <% studentList.forEach((item,index)=>{ %>
              <tr>
                <td><%-(index+1)%></td>
                <td><%-item._id%></td>
                <td><%-item.name%></td>
                <td><%-item.email%></td>
                <td>
                  <a href="/admin/user/edit/<%-item._id%>"
                    ><i style="color: red;" class="fas fa-edit"></i
                  ></a>
                </td>
                <td>
                  <a
                    href="#modalDelete"
                    data-toggle="modal"
                    onclick="getStudent('<%-index%>')"
                  >
                    <i style="color: red;" class="fas fa-archive"></i
                  ></a>
                </td>
              </tr>
              <%});%>
            </tbody>
          </table>
        </div>
        <!-- Tab Lecturer -->
        <div id="Lecturer" class="container tab-pane fade">
          <!-- Title Tab Lecturer -->
          <h2 class="text-primary">Lecturer List</h2>
            <!-- Search -->
            <input
            class="form-control"
            id="searchLecturer"
            type="text"
            placeholder="Search..."
          />
          <!-- Table list Students -->
          <table
            style="margin-top: 10px;"
            class="table table-bordered table-hover"
          >
            <!-- Header table -->
            <thead class="thead-dark">
              <tr>
                <th>STT</th>
                <th>ID</th>
                <th>Full Name</th>
                <th>Email</th>
                <th>Edit</th>
                <th>Delete</th>
              </tr>
            </thead>
            <!-- Body table -->
            <tbody id="tableLecturer">
              <% lecturerList.forEach((item,index)=>{ %>
              <tr>
                <td><%-(index+1)%></td>
                <td><%-item._id%></td>
                <td><%-item.name%></td>
                <td><%-item.email%></td>
                <td>
                  <a href="/admin/user/edit/<%-item._id%>"
                    ><i style="color: red;" class="fas fa-edit"></i
                  ></a>
                </td>
                <td>
                  <a
                    href="#modalDelete"
                    data-toggle="modal"
                    onclick="getLecturer('<%-index%>')"
                  >
                    <i style="color: red;" class="fas fa-archive"></i
                  ></a>
                </td>
              </tr>
              <%});%>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- Modal delete Student -->
    <div class="modal" id="modalDelete">
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h4 class="modal-title text-danger">DELETE USER</h4>
            <br />
            <button type="button" class="close" data-dismiss="modal">
              &times;
            </button>
          </div>

          <!-- Modal body -->
          <P
            style="text-align: center; margin-left: 10px; margin-right: 10px;"
            class="text-danger"
            id="studentName"
          ></P>
          <div
            style="margin-bottom: 10px;"
            class="row justify-content-center align-items-center"
          >
            <a
              style="margin-right: 10px;"
              id="deleteStudent"
              onclick="deleteStudent()"
              class="btn btn-danger col-3"
            >
              DELETE
            </a>
            <a type="button" class="btn btn-danger col-3" data-dismiss="modal">
              Close
            </a>
          </div>
        </div>
      </div>
    </div>
    <script>
      var studentList = <%-JSON.stringify(studentList)%>;
      var lecturerList = <%-JSON.stringify(lecturerList)%>;
      var searchStudent = $('#searchStudent');
      var searchLecturer = $('#searchLecturer');
      var tableStudent = $('#tableStudent tr');
      var tableLecturer = $('#tableLecturer tr');
      var title = document.getElementById("studentName");
      var submitDelete = document.getElementById("deleteStudent");
      var user;
      searchStudent.on("keyup", function() {
          var value = $(this).val().toLowerCase();
          tableStudent.filter(function() {
          $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
      });

      searchLecturer.on("keyup", function() {
          var value = $(this).val().toLowerCase();
          tableLecturer.filter(function() {
          $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
      });
      function getStudent(index) {
        user = studentList[index];
        console.log(user);
        title.innerHTML = "Are you sure you want to delete student: '" +
        user.name + "' with email: " + user.email + " ? you can not recovery this student!";
      }
      function getLecturer(index) {
        user = lecturerList[index];
        console.log(user);
        title.innerHTML = "Are you sure you want to delete lecturer: '" +
        user.name + "' with email: " + user.email + " ? you can not recovery this lecturer!";
      }
      function deleteStudent(){
        submitDelete.href = "/admin/user/delete/"+user._id;
      }
    </script>
  </body>
</html>
